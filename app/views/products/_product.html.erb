<% modified_time = File.mtime(product.router.path) %>
<tr>
  <td>
    <%= image_tag app_icon_path(product.app.name, product.app.type, product.app.owner), size: '100x100', title: product.app.icon_path %>
  </td>
  <td><%= product.name %></td>
  <td>
    <%= link_to product.title, app_path(product.app.name, product.app.type, product.app.owner) %>
    <% unless product.active_users.empty? %>
      <span class="label label-default pull-right"><%= pluralize product.active_users.size, "active user" %></span>
    <% end %>
    <p>
      <%= manifest_markdown(product.description) %>
    </p>
    <% unless product.valid?(:list_apps) %>
    <div class="alert alert-danger">
      <p>Manifest <%= product.errors[:manifest].first %></p>
    </div>
    <% end %>
  </td>
  <td data-order="<%= modified_time.to_i %>"><%= modified_time.strftime("%m/%d/%y") %></td>
  <td>
    <%= link_to 'Shell', OodAppkit.shell.url(host: ENV['OOD_DEV_SSH_HOST'] || 'default', path: product.router.path).to_s, target: '_blank', class: 'btn btn-default btn-block' %>
    <%= link_to 'Files', OodAppkit.files.url(path: product.router.path).to_s, target: '_blank', class: 'btn btn-default btn-block' %>
  </td>
  <td>
    <%= link_to 'Details', product_path(product.name, type: @type), class: 'btn btn-info btn-block' %>
    <%= link_to 'Edit', edit_product_path(product.name, type: @type), class: 'btn btn-default btn-block' %>
  </td>
  <td>
    <%= link_to 'Delete',
      product_path(product.name, type: @type),
      method: :delete,
      data: {
        original_title: 'Are you ABSOLUTELY sure?',
        confirm: '<div class="alert alert-warning">Unexpected bad things will happen if you don\'t read this!</div><p>This will move the product to the trash. Any users currently running this app will experience breaking behavior. Any past or present users of this app will be unable to access their data for this app. Be sure you know what you are doing!</p>'.html_safe,
        verify: product.name,
        verify_text: 'Please type in the name of the app to confirm.',
        commit: 'I understand the consequences, delete this app',
        commit_class: 'btn-danger btn-block',
        cancel_class: 'hide'
      },
      class: 'btn btn-danger pull-right'
    %>
  </td>
</tr>
