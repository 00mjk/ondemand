<% content_for :title, @app.title %>

<ol class="breadcrumb">
  <li>
    <%= link_to t('dashboard.breadcrumbs.home'), root_path %>
  </li>
  <li>
    <%= link_to t('dashboard.breadcrumbs.my_sessions'), batch_connect_sessions_path %>
  </li>
  <li class="active">
    <%= @app.title %>
  </li>
</ol>

<%- if @session && @session.errors.any? -%>
  <div class="alert alert-danger alert-dismissible" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    <%= session_save_errors @session.errors %>

    <p class="small">
      <%= t('dashboard.bc.sessions.data',
            title: @app.title,
            data_link_tag: link_to(
              t('dashboard.bc.sessions.staged_root'),
              OodAppkit.files.url(path: @session.staged_root).to_s,
              target: "_blank")
            ).html_safe
      %>
    </p>
  </div>
<%- end -%>

<div class="row">
  <div class="col-md-3">
    <%=
      render(
        partial: "batch_connect/shared/app_menu",
        locals: {
          sys_app_groups: @sys_app_groups,
          usr_app_groups: @usr_app_groups,
          dev_app_groups: @dev_app_groups,
          current_url: new_batch_connect_session_context_path(token: @app.token)
        }
      )
    %>
  </div>

  <div class="col-md-6">
    <h3><%= @app.title %></h3>
    <div class="ood-appkit markdown">
      <%= OodAppkit.markdown.render(@app.description).html_safe %>

      <%- if @session_context -%>
        <%= render "form" %>

        <p class="small">
          <%= t('dashboard.bc.form.session_data',
                title: @app.title,
                data_link_tag: link_to(
                  t('dashboard.bc.form.data_root'),
                  OodAppkit.files.url(
                    path: BatchConnect::Session.dataroot(@app.token)
                  ).to_s,
                  target: "_blank")
                ).html_safe
          %>
        </p>
      <%- end -%>
    </div>
  </div><!-- /.col-md-6 -->
</div><!-- /.row -->
